<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- Compiled and minified CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
  </head>
  <body>
    <!-- use videos starting for following code https://www.youtube.com/watch?v=4wa3CMK4E2Y&list=PL4cUxeGkcC9jUPIes_B8vRjn1_GaplOPQ&index=18  
    code is also at https://github.com/iamshaunjp/firebase-auth/tree/lesson-18-->

    <h1 class="center-align"  style="color:green">Do you see me</h1>

    <section class="center-align"   id="get-with-authorization" >
      <div style="margin-bottom: 35px;">
        <a id="getAuth" class="waves-effect waves-light btn" href="#">Punch Me</a>
      </div>

      <p id="resp" style="margin-bottom: 30px;"></p>
      

      <script>
        const getAuth = document.querySelector('#getAuth');
        const resp = document.querySelector('#resp');
        getAuth.addEventListener('click', () => {
          console.log("before fetch");
          fetch('https://us-central1-taswell-f90e4.cloudfunctions.net/app/helloworld', {
            headers: new Headers({
              'Auth': '44819bd32d8e799f3042d06ed0a3329632608c17'})
            })
          .then(response => {
            return response.text();
          })
          .then(data => {
            console.log(data);
            resp.innerHTML = data;
          });
        });
      </script>

    <section id="modal-materialize">
      <!-- Modal Trigger Button-->
      <a class="waves-effect waves-light btn modal-trigger" href="#modal1"
        >Modal</a >

      <!-- Modal Structure -->
      <div id="modal1" class="modal">
        <div class="modal-content">
          <div class="container" id="user-section">
            <div class="row">
              <div class="col s6">
                <form id="getContribution">

                  <div class="row">
                    <div class="input-field">
                      <input type="number" id="amount" required validate />
                      <label for="amount">Enter Amount</label>
                    </div>
                  </div>


                  <div class="row">
                    <div class="input-field">
                      <select id="currency">
                        <!-- <option value="" disabled selected>Amount</option> -->
                        <option value="dollars">US Dollars</option>
                        <option value="euros">Euros</option>
                        <option value="pounds">Pounds</option>
                      </select>
                      <label>Pick Your Currency</label>
                    </div>
                  </div>

                  <div class="row">
                    <!-- <div class="input-field"> -->
                      <label >
                        <input name="duration" class="with-gap" id="one-time" type="radio" value="one-time" checked />
                        <span>One Time Donation</span>
                      </label>
                    <!-- </div> -->
                  </div>

                  <div class="row">
                    <!-- <div class="input-field"> -->
                      <label >
                        <input type="radio" value="recurring"  class="with-gap" id="recurring" name="duration"/>
                        <span>Recurring Donation</span>
                      </label>
                    <!-- </div> -->
                  </div>

                  <div class="input-field">
                    <input
                      type="submit"
                      class="btn teal orange-text center lighten-3 modal-close"
                      value="Submit"
                    />
                  </div>

                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Compiled and minified JavaScript Materialize-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-app.js"></script>
    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-analytics.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-functions.js"></script>

    <!-- Initialize Firebase Following is used when native Firebase hosting-- use below firebaseConfig and firebase.initializeApp -->
    <!-- <script src="/__/firebase/init.js"></script> -->

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCAM2TgIq8dfhx08OvCtz4QULMYvp9HS-8",
        authDomain: "taswell-f90e4.firebaseapp.com",
        databaseURL: "https://taswell-f90e4.firebaseio.com",
        projectId: "taswell-f90e4",
        storageBucket: "taswell-f90e4.appspot.com",
        messagingSenderId: "277717169423",
        appId: "1:277717169423:web:ca937f0e05387e50703a7a",
      };

      firebase.initializeApp(firebaseConfig);

      const functions = firebase.functions();
      const getContributionForm = document.querySelector("#getContribution");

      getContributionForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const amount = document.querySelector("#amount").value;
        // const currency = document.querySelector("#currency").value;
        // const duration = document.querySelectorAll("[name=duration]").value;
        const contribution = functions.httpsCallable("getContribution");
        contribution({ amount }).then((result) => console.log(result));
      });
    </script>

    <!-- Initialize materialize javascript after DOM loads -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var elems = document.querySelectorAll(".modal");
        var instances = M.Modal.init(elems, {});
        var select = document.querySelector("select");
        const instances2 = M.FormSelect.init(select, {});
      });
    </script>
  </body>
</html>
